<?xml version="1.0" encoding="UTF-8"?>
<con:soapui-project id="fdde477c-81f0-4fd0-a7f9-4aa8fb53d377" activeEnvironment="Default" name="OTK-4.2" resourceRoot="" soapui-version="5.4.0" abortOnError="false" runType="SEQUENTIAL" xmlns:con="http://eviware.com/soapui/config"><con:description>This project executes a complete OpenID Connect flow. Update these 'Custom Properties': host, user, password</con:description><con:settings/><con:testSuite id="9adaf79a-8305-464e-8d78-5a527f340b03" name="Example TestSuite"><con:settings/><con:runType>SEQUENTIAL</con:runType><con:testCase id="f7d798f0-19b8-469a-aac0-952f53c69557" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="OpenID-Config-Registration" searchProperties="true"><con:settings/><con:testStep type="httprequest" name="GetConfiguration" id="34f3a985-0c85-4519-a79b-0f2882738c3f"><con:settings/><con:config method="GET" xsi:type="con:HttpRequest" id="a3b23d0d-1d5a-4945-a1d0-ddc278cd9540" name="GetConfiguration" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:description>Get the OpenID server configuration</con:description><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>${#Project#host}${#Project#path_configuration}</con:endpoint><con:request/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:config></con:testStep><con:testStep type="transfer" name="ConfigDetails" id="edb48cb6-22fc-44a6-b839-6e67953174d1"><con:description>Extract a few details such as the path to '/register'</con:description><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>Path_Register</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>GetConfiguration</con:sourceStep><con:sourcePath>registration_endpoint</con:sourcePath><con:targetType>Endpoint</con:targetType><con:targetStep>DynamicClientRegistration</con:targetStep><con:type>JSONPATH</con:type><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="false" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>Path_Token</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>GetConfiguration</con:sourceStep><con:sourcePath>token_endpoint</con:sourcePath><con:targetType>path_token</con:targetType><con:targetStep>#TestSuite#</con:targetStep><con:type>JSONPATH</con:type><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="false" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>Path_Authorize</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>GetConfiguration</con:sourceStep><con:sourcePath>authorization_endpoint</con:sourcePath><con:targetType>path_authorize</con:targetType><con:targetStep>#TestSuite#</con:targetStep><con:type>JSONPATH</con:type><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="false" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>Path_Userinfo</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>GetConfiguration</con:sourceStep><con:sourcePath>userinfo_endpoint</con:sourcePath><con:targetType>path_userinfo</con:targetType><con:targetStep>#TestSuite#</con:targetStep><con:type>JSONPATH</con:type><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="false" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>Path_JWKS</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>GetConfiguration</con:sourceStep><con:sourcePath>jwks_uri</con:sourcePath><con:targetType>path_jwks</con:targetType><con:targetStep>#TestSuite#</con:targetStep><con:type>JSONPATH</con:type><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="groovy" name="GenerateOrg" id="5cf520c9-60e8-4c98-87d2-ea262568ee28"><con:description>This is used as 'fake' organization name to combine it with the client_name. This way, for the demo, we can register the 'same' client multiple times</con:description><con:settings/><con:config><script>def fakeOrg = new Date().format("HHmmssSSSSSS")</script></con:config></con:testStep><con:testStep type="transfer" name="TransferFakeOrg" id="1f9c8623-ab99-4ec1-8d4f-1c3bcc4720a9"><con:description>Extract the fakeOrg value into the property 'fakeOrg'</con:description><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>fakeOrg</con:name><con:sourceType>result</con:sourceType><con:sourceStep>GenerateOrg</con:sourceStep><con:targetType>fakeOrg</con:targetType><con:targetStep>fakeOrg</con:targetStep><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="properties" name="fakeOrg" id="64fa6721-437d-45c0-bad7-ac1f0da23b65"><con:description>Property holding the value of 'fakeOrg'</con:description><con:settings/><con:config xsi:type="con:PropertiesStep" saveFirst="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:properties><con:property><con:name>fakeOrg</con:name><con:value>093105000110</con:value></con:property></con:properties></con:config></con:testStep><con:testStep type="httprequest" name="DynamicClientRegistration" id="9000ffcc-6577-4529-ab3f-1609f1fed92e"><con:settings/><con:config method="POST" xsi:type="con:HttpRequest" id="6bceded6-80a6-42ec-af39-b0a8a7db1e58" name="DynamicClientRegistration" postQueryString="false" mediaType="application/json" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:description>Register a new client. If this fail the client has been registered beforehand with the same details</con:description><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>https://otk-ifttt.tutorial.com:443/openid/connect/register</con:endpoint><con:request>{
	"application_type": "${#Project#application_type}",
	"redirect_uris": ["${#Project#redirect_uri}"],
	"client_name": "${#Project#client_name}-${#fakeOrg}",
	"subject_type": "pairwise",
	"token_endpoint_auth_method": "client_secret_basic",
	"contacts": ["${#Project#contact_alias}","${#Project#contact_email}"]
}</con:request><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:config></con:testStep><con:testStep type="transfer" name="RegistrationDetails" id="47141701-b6a0-48ce-a441-0befdfa1a395"><con:description>Extract details such as the access_token and registration_client_uri</con:description><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>client_id</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>DynamicClientRegistration</con:sourceStep><con:sourcePath>client_id</con:sourcePath><con:targetType>client_id</con:targetType><con:targetStep>#TestSuite#</con:targetStep><con:type>JSONPATH</con:type><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>client_secret</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>DynamicClientRegistration</con:sourceStep><con:sourcePath>client_secret</con:sourcePath><con:targetType>client_secret</con:targetType><con:targetStep>#TestSuite#</con:targetStep><con:type>JSONPATH</con:type><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>scope</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>DynamicClientRegistration</con:sourceStep><con:sourcePath>scope</con:sourcePath><con:targetType>scope</con:targetType><con:targetStep>#TestSuite#</con:targetStep><con:type>JSONPATH</con:type><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="groovy" name="GenerateState" id="70ee75cd-eb7b-421a-965c-b7c7793cc823"><con:description>Using the time as 'state'. This would usually be something like a client sessionID</con:description><con:settings/><con:config><script>new Date().format("HHmmss")</script></con:config></con:testStep><con:testStep type="transfer" name="TransferState" id="6b0cb866-a65d-4c5f-a22c-ec6d842f72e5"><con:description>Move the generate 'state' into our authorization request</con:description><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>state</con:name><con:sourceType>result</con:sourceType><con:sourceStep>GenerateState</con:sourceStep><con:targetType>state</con:targetType><con:targetStep>AuthorizationRequest - code</con:targetStep><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="httprequest" name="AuthorizationRequest - code" id="990996d9-b097-4d0d-864b-fe79eba4c731"><con:settings/><con:config method="GET" xsi:type="con:HttpRequest" id="4fe1991a-a88f-418a-b529-5ad6c3be6ba8" name="AuthorizationRequest - code" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:description>Initiating the authorization code flow. The response is a redirect, 302, which we simply follow</con:description><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting><con:setting id="com.eviware.soapui.impl.support.AbstractHttpRequest@follow-redirects">true</con:setting></con:settings><con:endpoint>${#TestSuite#path_authorize}</con:endpoint><con:request/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters><con:parameter><con:name>client_id</con:name><con:value>${#TestSuite#client_id}</con:value><con:style>QUERY</con:style></con:parameter><con:parameter><con:name>response_type</con:name><con:value>code</con:value><con:style>QUERY</con:style></con:parameter><con:parameter><con:name>redirect_uri</con:name><con:value>${#Project#redirect_uri}</con:value><con:style>QUERY</con:style></con:parameter><con:parameter><con:name>scope</con:name><con:value>${#TestSuite#scope}</con:value><con:style>QUERY</con:style></con:parameter><con:parameter><con:name>state</con:name><con:value>093105</con:value><con:style>QUERY</con:style></con:parameter><con:parameter><con:name>prompt</con:name><con:value>login</con:value><con:style>QUERY</con:style></con:parameter><con:parameter><con:name>id_token_hint</con:name><con:value>old-id-token</con:value><con:style>QUERY</con:style></con:parameter></con:parameters></con:config></con:testStep><con:testStep type="transfer" name="AuthorizationResponseDetails" id="97813b82-9051-46f1-92a6-dadb085355ab"><con:description>Extract details that we need for the next request</con:description><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>sessionID</con:name><con:sourceType>ResponseAsXml</con:sourceType><con:sourceStep>AuthorizationRequest - code</con:sourceStep><con:sourcePath>//input[@name='sessionID']/@value</con:sourcePath><con:targetType>sessionID</con:targetType><con:targetStep>Authentication</con:targetStep><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>sessionData</con:name><con:sourceType>ResponseAsXml</con:sourceType><con:sourceStep>AuthorizationRequest - code</con:sourceStep><con:sourcePath>//input[@name='sessionData']/@value</con:sourcePath><con:targetType>sessionData</con:targetType><con:targetStep>Authentication</con:targetStep><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>location</con:name><con:sourceType>ResponseAsXml</con:sourceType><con:sourceStep>AuthorizationRequest - code</con:sourceStep><con:sourcePath>//form/@action</con:sourcePath><con:targetType>Endpoint</con:targetType><con:targetStep>Authentication</con:targetStep><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="httprequest" name="Authentication" id="a6c3f9e3-d441-46a1-be68-6d03787ed103"><con:settings/><con:config method="POST" xsi:type="con:HttpRequest" id="2d4a94f2-41bf-49f3-85ea-b088fd75dcfa" name="Authentication" postQueryString="true" mediaType="application/x-www-form-urlencoded" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:description>Auhenticating the user. The request includes details of the previous response</con:description><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>https://otk-ifttt.tutorial.com:443/auth/oauth/v2/authorize/login</con:endpoint><con:request/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters><con:parameter><con:name>username</con:name><con:value>${#Project#user}</con:value><con:style>QUERY</con:style></con:parameter><con:parameter><con:name>password</con:name><con:value>${#Project#password}</con:value><con:style>QUERY</con:style></con:parameter><con:parameter><con:name>sessionID</con:name><con:value>552b8178-6d26-47da-9481-f630cb2700a6</con:value><con:style>QUERY</con:style></con:parameter><con:parameter><con:name>sessionData</con:name><con:value>eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.ew0KICAgICJzZXNzaW9uIjogew0KICAgICAgICAic2Vzc2lvbklEIjoiNTUyYjgxNzgtNmQyNi00N2RhLTk0ODEtZjYzMGNiMjcwMGE2IiwNCiAgICAgICAgImV4cCI6MTUyOTc3MTc3MSwNCiAgICAgICAgImN1cnJlbnRfdXNlcm5hbWUiOiIiLA0KICAgICAgICAiY3VycmVudF91c2VyX2NvbnNlbnQiOiJub25lIiwNCiAgICAgICAgImN1cnJlbnRfdXNlcl9yb2xlIjoiIiwNCiAgICAgICAgImN1cnJlbnRfdXNlcl9hY3IiOiIwIiwNCiAgICAgICAgImN1cnJlbnRfdXNlcl9hdXRoVGltZSI6IjAiLA0KICAgICAgICAic2FsdCI6IiIsDQogICAgICAgICJ0aGlyZF9wYXJ0eV9zc29fdG9rZW4iOiIiLA0KICAgICAgICAidGhpcmRfcGFydHlfc3NvX3Rva2VuX3R5cGUiOiIiDQogICAgfSwNCiAgICAicmVxdWVzdF9jb25zZW50Ijogew0KICAgICAgICAiY2xpZW50X25hbWUiOiJDQStPVEsrRGVtbytUZXN0K1N1aXRlLTA5MzEwNTAwMDExMCIsDQogICAgICAgICJzY29wZV92ZXJpZmllZCI6Im9wZW5pZCtlbWFpbCtwcm9maWxlK29wZW5pZF9jbGllbnRfcmVnaXN0cmF0aW9uIg0KICAgIH0sDQogICAgInJlcXVlc3RfcGFyYW1ldGVycyI6IHsNCiAgICAgICAgImRpc3BsYXkiOiJwYWdlIiwNCiAgICAgICAgInByb21wdCI6ImxvZ2luIiwNCiAgICAgICAgImlkX3Rva2VuX2hpbnQiOiJvbGQtaWQtdG9rZW4iLA0KICAgICAgICAibG9naW5faGludCI6IiIsDQogICAgICAgICJhY3JfdmFsdWVzIjoiIiwNCiAgICAgICAgImNsaWVudF9pZCI6IjBmYjBmZDQ5LTE5OWUtNGUxNS04ZDUzLTc4NWFlNGFmOTM2MCIsDQogICAgICAgICJub25jZSI6IiIsDQogICAgICAgICJzY29wZSI6Im9wZW5pZCtlbWFpbCtwcm9maWxlK29wZW5pZF9jbGllbnRfcmVnaXN0cmF0aW9uIiwNCiAgICAgICAgIm1heF9hZ2UiOiAiIg0KICAgIH0NCn0.qMKkTXdrcc3wOk0rK92KCKqrYbPLLMnp30HdsonX6Ic</con:value><con:style>QUERY</con:style></con:parameter><con:parameter><con:name>action</con:name><con:value>login</con:value><con:style>QUERY</con:style></con:parameter></con:parameters></con:config></con:testStep><con:testStep type="transfer" name="AuthenticationResponseDetails" id="bfb190a0-f647-4094-991c-c629eaf0086a"><con:description>Extract details for the next request</con:description><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>sessionID</con:name><con:sourceType>ResponseAsXml</con:sourceType><con:sourceStep>Authentication</con:sourceStep><con:sourcePath>//input[@name='sessionID']/@value</con:sourcePath><con:targetType>sessionID</con:targetType><con:targetStep>ConsentRequest</con:targetStep><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>sessionData</con:name><con:sourceType>ResponseAsXml</con:sourceType><con:sourceStep>Authentication</con:sourceStep><con:sourcePath>//input[@name='sessionData']/@value</con:sourcePath><con:targetType>sessionData</con:targetType><con:targetStep>ConsentRequest</con:targetStep><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>action</con:name><con:sourceType>ResponseAsXml</con:sourceType><con:sourceStep>Authentication</con:sourceStep><con:sourcePath>//input[@name='action']/@value</con:sourcePath><con:targetType>action</con:targetType><con:targetStep>ConsentRequest</con:targetStep><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>location</con:name><con:sourceType>ResponseAsXml</con:sourceType><con:sourceStep>Authentication</con:sourceStep><con:sourcePath>//form/@action</con:sourcePath><con:targetType>Endpoint</con:targetType><con:targetStep>ConsentRequest</con:targetStep><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="httprequest" name="ConsentRequest" id="14d1cbb9-ec19-4ccf-a10d-ec2fe674b363"><con:settings/><con:config method="POST" xsi:type="con:HttpRequest" id="63624d4d-e15c-4f2b-8278-55b57e17fae5" name="ConsentRequest" postQueryString="true" mediaType="application/x-www-form-urlencoded" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:description>Request the 'Consent' page</con:description><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>https://otk-ifttt.tutorial.com:443/auth/oauth/v2/authorize/consent</con:endpoint><con:request/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters><con:parameter><con:name>sessionID</con:name><con:value>552b8178-6d26-47da-9481-f630cb2700a6</con:value><con:style>QUERY</con:style></con:parameter><con:parameter><con:name>sessionData</con:name><con:value>eyJ0eXAiOiJKV1QiLCJjdHkiOiJKV1QiLCJhbGciOiJkaXIiLCJlbmMiOiJBMTI4Q0JDLUhTMjU2In0..3iFP8AYXMAFIwo9ErqAA1w.oMz_1wUkGpl0L61DwZKPClOQAVpnOjRqZ37uKlwfY9phm_O8w7d4Or_utF4rGLwYNEmyo1b29sJc6Bitw6cOJGYgxIndFNsVlPJ0nUwOSsaN0A-pkpMwmrYp4IBGbo0We0GHnAKbaalcJK5DLc54c3XmEyCME1FYAHDWglt9aw8UGYhYUoF6K7ipH9X9SMMybrWLTmckRsConr0TeOtYgmCve3yoTuChSeyyoSLdCpJEGm3JXvfWN17jB6KeXWEeqlV5gSxk9LIQOsLWGJdf0mqzwtm2kLNzQUH4bWSIcLSfZEBuYqnWupNGJGjZbYwBkfCx_fM_e6t3qm4OrS6iALJGSkdbofhs9vS1xiSXEK0wAk8FxLPxSNKFHEp_f8HzeeV4L73rw1E1yP3-xIk0fHferNcS3S3fT0GRaAJgwVc7qFtHAjm8n4POGbJ2lK_NzPuXv0zzO28NrNOVhhGNYAb3h_zxlKfNkxMYyqMN2KvPnDG7y6d7aPxPrwXoAHTKr0p8cb6oU8lHqdPuxBAGK10I1oDvzXbWtG6hvPzpgh9J1g5ZLzQKwWB4huxLyNcxPwBSX53Ee3GC15ae4jeJOSNAONL-aY76r5NVvG-mJORGx6OIJVbdNR5JPsXPnEEq1dx3FePcn_Qo3jPqLbdsTHgvcS9iUsDcXw2ysdoBq650_f6tEEhzt0DM9PaDKHl8ks3sxqql9iCDphiPY_Uxb2JTDPCiv3_Bo4Wi-IEsRH9VYahq5U0xuzvVYQuvBEK3PnVfNF71M3LEyjif1uURPk9Pywk1Fn_lAWPOvecXUeIB4A7x8AZA9b4f7penEZsgkuVLAgEM3SV9eTbQwwZ44vZT1V_qohRZkTW3oXbwZWRRnx1v5nhSrHNffjW44EoGJF3pmo4MMMj7B9js9Z6vjgQu2M22N1STTFIkVJtEPMwU1aKHPUhzzrsBbmtWSWqGOJnt1sbZQhYZxRjwxqvzjSjz7G0QTFhb42KzxkDRohkLReN3ycxBK8CFrZqDEZPuJy59lDQF5pGGkvHUOL6g5io45rUo7cNiZQcvTuGx-o9IdcbAjkCBFSm3QMYKutditUVR17cDOToRN9dOC9QnlQ2OB0QtkvCquRHQaJwQOaycrDwNjoN8zWncjDKUnWs97BieXQUVUA38L8cjy1dHzhV6Sg_MH96_RhITfeVeB7Qynl2HpyN6nejQRQJN3C3d7GtRagHPGRRkO0mA8bj-fwUKi--G-jNY5FtDhhJOJOZmcjiOzxxj4OMoDwAKk-EwqQ4OiRs2U50JMOW2FkL9_rKWCEmi_ZqX-VGInx3ks3Eg0oQSW_Gi0kNVgv-ftCwgqUf7l72oJLG2CEsC3CP-qDbQN7aAOgxFHxccRg44LKPLv2v9Dk4bv9PkCnI3FaKEeWHFb7n6wkNARTttP5MZEcOKwpXyd8jXGQWhYRCgJJweXkKLbUYr8oZtLHXYqaUbGI96a8zekv8Xqh-lL0CSMh4yGeRnCWV_NCz_rM-rBfSxvFCYNfd_Di8hBqci7oH3q-fDNRLn7gSkFRJ1cb2W8ScD_QJQOQhmZAQpqCgzelvpQVUBHKZzgGrNXE5MwkxvyfxVZYp1qsbH9KU7WZnrcb3VfcTtLMvL0h61VzWcvb7Ue6kdtfF8R4JxW1skFOIjA1-DUpKEXimr0NEwAGYimrBMFmXn-TOJnOHgCfIVl07uwxwwo8mKflwQVsGM_6y1M8lbn8fx164W1BMgxBlKsHZTuCGgyi6xbwzL21VvardtBt-F9PmyFRgorhbgLv4OVHbcQ2RYVwJ7d4CAQUXd9cX5fl1xCIraAND71rLk844.p-1X8siDwQDyLc3IQDqK1g</con:value><con:style>QUERY</con:style></con:parameter><con:parameter><con:name>action</con:name><con:value>consent</con:value><con:style>QUERY</con:style></con:parameter></con:parameters></con:config></con:testStep><con:testStep type="transfer" name="ConsentRequestDetails" id="d216157b-3378-40d0-8472-581ade5ca36c"><con:description>Extract details for the next request</con:description><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>sessionID</con:name><con:sourceType>ResponseAsXml</con:sourceType><con:sourceStep>ConsentRequest</con:sourceStep><con:sourcePath>//input[@name='sessionID']/@value</con:sourcePath><con:targetType>sessionID</con:targetType><con:targetStep>Consent</con:targetStep><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>sessionData</con:name><con:sourceType>ResponseAsXml</con:sourceType><con:sourceStep>ConsentRequest</con:sourceStep><con:sourcePath>//input[@name='sessionData']/@value</con:sourcePath><con:targetType>sessionData</con:targetType><con:targetStep>Consent</con:targetStep><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>location</con:name><con:sourceType>ResponseAsXml</con:sourceType><con:sourceStep>ConsentRequest</con:sourceStep><con:sourcePath>//form/@action</con:sourcePath><con:targetType>Endpoint</con:targetType><con:targetStep>Consent</con:targetStep><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="httprequest" name="Consent" id="c4813f0b-090b-4c61-a949-add3909f227c"><con:settings/><con:config method="POST" xsi:type="con:HttpRequest" id="2fe0bc4d-61a9-4514-b6d5-a00d0e7357ea" name="Consent" postQueryString="true" mediaType="application/x-www-form-urlencoded" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:description>Grant (consent) access to my resources. Important with SOAPUI is to not follow the redirect in the response. That location does not exist!</con:description><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting><con:setting id="com.eviware.soapui.impl.support.AbstractHttpRequest@follow-redirects">false</con:setting></con:settings><con:endpoint>https://otk-ifttt.tutorial.com:443/auth/oauth/v2/authorize/consent</con:endpoint><con:request/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters><con:parameter><con:name>sessionID</con:name><con:value>552b8178-6d26-47da-9481-f630cb2700a6</con:value><con:style>QUERY</con:style></con:parameter><con:parameter><con:name>sessionData</con:name><con:value>eyJ0eXAiOiJKV1QiLCJjdHkiOiJKV1QiLCJhbGciOiJkaXIiLCJlbmMiOiJBMTI4Q0JDLUhTMjU2In0..UBtHF7mWrbXizpGHbWMv8Q.9TfoYdYUgwv4EF1l39mhIxHL25Xov4-PBnwi_RSISMxpcB1ifsJK1OEN4pYkOR3C_Bf0cFr9TGj8gG7FjvqlMUGWpj-rs-Qd6_F3rP1uBPLViwhPS-cZrtO0b7DZT4HORKIiIs6gbHo5rMS5V19wkZrpxpjk8dIWfyF4MXt_gsjefWOrLiss7Qh767QdkJwyKf-w-emJ2ruF2KQI58TxaGUNAsh9ybobtP1MP9_92ixz5r4Xstp1YwDHnScrvuqTpdrEcfFagTH7vFV54zdqwAbwrzvBdMS-0xjc6lixrLyR6YkFJyYR2SpPLcFu1AZRhc-UaVvLM5nzE1zhXdpX-D2kHmDsMZFDGMap8tgcnzS1T8ghpyRDcrNlkW2ssc5UdBpSGeCPnV-bFSHszCIwzVSqsxYwsInK8Z9gDKMtBjFYNGTlkJIY4wKGXokp5RFHydIVxdHIlsNE6o0KjktN05cTQef1G1nX_kg9oo9-umemlXTTO8Ex3LIpGr2arW5WBcpAGO1ml-z9BqC34AF1T1szTYBoGWhyzzpzF1p-25zTiEkLjxJrTu_Q5vBnq1kohQz2gEsaAxJznAHtt9PL5obxNDEbX1AoatER7EPoRVVxo4Wb8Ufx88nTKRYLJBlr2QEiaMp_p-n8fMNgyIVPZqHKSQpkEIcp2x4HCl25EwT16U8BDZDzkKgpaRKr50w1uNKht_87Q8OTw-TjWVqv2AzEQzRmRO8J286puz3DQEC6AQSD6nzYhFCUgcR_WfU0uYghpmjTut_wzBFg_jyDFynBRYBpu3ji3XBuUdg8PAFSTA3CAOoJLsuQAZcrtz6Z4g4z4aRVT-EBO8_zyavhrrZiJ2HKwGMuDMlAQeI6gb5eFB1M7qxPbfd4zq7B6EjXE7fb98Xa5SB5o-jYR6P41ZpumetHAnnVYDqWCQ18Ln4WcraoE-BM5jC1DMp3RC60KkGrRJ3fvI-APQp6PuCNnyHlR_Q6Qo8awBLPg-c9Y_IW2f1WnB6hVXWL0E8L0Yr2s38vUqOYl0MSr7wmIVcT3q0nyMnVnOqiQgnBWUuChUyXTljiQsVvnFk7p9B4pn3_wySFb-GUOZ74kuwiulCReuXd80U-NxH3lxuZj4nwU-x4sCAQehkQaF5SbN7T7JB4-_A8FQf5RZhC5pgoGBsKXoyhRzBTB9c26N6cjEEHYLV7KYImR6sJO_SGH6CRnc4zcEhxyHUiH-Lt5ekOfaXQJ4tCXH7ZgJrYr6904_azyTVv35dI1A03U413-KSk0c_TcMalQSJ8JCQOK0c5NOU8HLryRoUMd3dPRW4efG5-2436O59bVONzn_IOq8Q53FDey8kltcunaLWhyLIB6rf0njoIvz1mSP88u2QnyY06UIAXymhS7w3T-auLJvetprXFwYOfMmaMpjJhDszt-Hke5InIEXfl2aJ5KD8jATvGAacd92rmtZLGWkt-XcgacWPct1SupSKz4exizFYJA7PbwYMqFQOWtzfl0j2k4I03sNuFpZcOEvKr3XkHYbk3zQ2nQmng2QcRcEYIoAh9cygpHrxymLmRNb_Y-qcpOcEty-QEwxyzrDj_LMxw0-pbJ5GiGOPReB03JA-6ymx2iUF8Uk8IiNLEpw3uR09a5M17sj-sjmW5R1jLTU_C8cKbYH0sqC7rFBIFCEW5zQdidYvrg4dwN5Oc-BQAF-TZzduQT1a1fW3KUTfH99DWjACEss-4uoH9_enFRsD5NdsetuMVGy4lWDf-cYJSa6ibentsfxAjn0mp_oNJf6GNPGJDcEdlIaA6xDwAYOaQlrt3J6WssY5PYTdDjlB9mZDlQv0DNlO_ZTFNmmuS40vYiak_RDOL.AHO9NXwlL8mA52MZktVx3g</con:value><con:style>QUERY</con:style></con:parameter><con:parameter><con:name>action</con:name><con:value>Grant</con:value><con:style>QUERY</con:style></con:parameter></con:parameters></con:config></con:testStep><con:testStep type="groovy" name="ExtractCode" id="cd21e13d-ca4b-490f-ac35-90ecbad31c11"><con:description>The 'code' was retured in the Location header. We now etract it from there</con:description><con:settings/><con:config><script>def location = testRunner.testCase.getTestStepByName("Consent").httpRequest.response.responseHeaders["Location"][0]
def m = location =~ /code=([^&amp;]+)/;
if (!m) {
throw new RuntimeException("No code returned!");
}
m.group(1);</script></con:config></con:testStep><con:testStep type="transfer" name="TransferCode" id="f0a6ff0c-4882-40e9-b8c2-3654f5584eca"><con:description>After extracting the 'code' we are using it in our 'TokenRequest'</con:description><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>code</con:name><con:sourceType>result</con:sourceType><con:sourceStep>ExtractCode</con:sourceStep><con:targetType>code</con:targetType><con:targetStep>TokenRequest</con:targetStep><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="httprequest" name="TokenRequest" id="fb3a3a0d-a80e-4eb7-bdb3-abed52bf6739"><con:settings/><con:config method="POST" xsi:type="con:HttpRequest" id="40f12287-ec84-4e44-a5c9-f1f9fa6a152b" name="TokenRequest" postQueryString="true" mediaType="application/x-www-form-urlencoded" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:description>Use the received 'code' to exchange it for an access_token</con:description><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>${#TestSuite#path_token}</con:endpoint><con:request/><con:assertion type="Valid HTTP Status Codes" id="50d93b89-fb3b-4b09-ad1c-46773a0418f4" name="status=200"><con:configuration><codes>200</codes></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters><con:parameter><con:name>client_id</con:name><con:value>${#TestSuite#client_id}</con:value><con:style>QUERY</con:style></con:parameter><con:parameter><con:name>client_secret</con:name><con:value>${#TestSuite#client_secret}</con:value><con:style>QUERY</con:style></con:parameter><con:parameter><con:name>code</con:name><con:value>2c4bdd32-d78d-4361-ba7f-c7d431e5c853</con:value><con:style>QUERY</con:style></con:parameter><con:parameter><con:name>grant_type</con:name><con:value>authorization_code</con:value><con:style>QUERY</con:style></con:parameter><con:parameter><con:name>redirect_uri</con:name><con:value>${#Project#redirect_uri}</con:value><con:style>QUERY</con:style></con:parameter></con:parameters></con:config></con:testStep><con:testStep type="transfer" name="TransferToken" id="63b09ad1-3cdd-41fa-9d66-246f4980db4a"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>access_token</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>TokenRequest</con:sourceStep><con:sourcePath>access_token</con:sourcePath><con:targetType>access_token</con:targetType><con:targetStep>Userinfo</con:targetStep><con:type>JSONPATH</con:type><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="httprequest" name="Userinfo" id="833fdb07-12ca-4780-9c9e-9e26fa11cc20"><con:settings/><con:config method="POST" xsi:type="con:HttpRequest" id="faee9095-b5f7-4060-989c-0def31a1dcdc" name="Userinfo" postQueryString="true" mediaType="application/x-www-form-urlencoded" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:description>Now we will use the received access_token to call the userinfo endpoint</con:description><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>${#TestSuite#path_userinfo}</con:endpoint><con:request/><con:assertion type="JsonPath Match" id="a533a2dc-0fd7-4c4e-ad08-ca0a191d7bde" name="preferred_username=user"><con:configuration><path>preferred_username</path><content>${#Project#user}</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters><con:parameter><con:name>access_token</con:name><con:value>92700bb3-600d-4feb-923c-ec8bec46bdfb</con:value><con:style>QUERY</con:style></con:parameter></con:parameters></con:config></con:testStep><con:loadTest id="3576855f-4296-417e-bf03-62d3da3746fc" name="LoadTest 1"><con:settings/><con:threadCount>5</con:threadCount><con:startDelay>0</con:startDelay><con:sampleInterval>250</con:sampleInterval><con:calculateTPSOnTimePassed>true</con:calculateTPSOnTimePassed><con:resetStatisticsOnThreadCountChange>true</con:resetStatisticsOnThreadCountChange><con:historyLimit>-1</con:historyLimit><con:testLimit>60</con:testLimit><con:limitType>TIME</con:limitType><con:loadStrategy><con:type>Simple</con:type></con:loadStrategy><con:assertion type="Step Status" name="Step Status"/><con:maxAssertionErrors>100</con:maxAssertionErrors><con:cancelExcessiveThreads>true</con:cancelExcessiveThreads><con:strategyInterval>500</con:strategyInterval></con:loadTest><con:loadTest id="f73a6ab2-90f3-4560-a09b-bb686cd07685" name="LoadTest 2"><con:settings/><con:threadCount>50</con:threadCount><con:startDelay>0</con:startDelay><con:sampleInterval>250</con:sampleInterval><con:calculateTPSOnTimePassed>true</con:calculateTPSOnTimePassed><con:resetStatisticsOnThreadCountChange>true</con:resetStatisticsOnThreadCountChange><con:historyLimit>-1</con:historyLimit><con:testLimit>60</con:testLimit><con:limitType>TIME</con:limitType><con:loadStrategy><con:type>Simple</con:type></con:loadStrategy><con:assertion type="Step Status" name="Step Status"/><con:maxAssertionErrors>100</con:maxAssertionErrors><con:cancelExcessiveThreads>true</con:cancelExcessiveThreads><con:strategyInterval>500</con:strategyInterval></con:loadTest><con:loadTest id="c7c773f2-80c2-4430-aa05-9248dd6e611e" name="LoadTest 3"><con:settings/><con:threadCount>1</con:threadCount><con:startDelay>0</con:startDelay><con:sampleInterval>250</con:sampleInterval><con:calculateTPSOnTimePassed>true</con:calculateTPSOnTimePassed><con:resetStatisticsOnThreadCountChange>true</con:resetStatisticsOnThreadCountChange><con:historyLimit>-1</con:historyLimit><con:testLimit>30</con:testLimit><con:limitType>TIME</con:limitType><con:loadStrategy><con:type>Simple</con:type></con:loadStrategy><con:assertion type="Step Status" name="Step Status"><con:configuration><name>Step Status</name><min-requests>0</min-requests><test-step>- Any -</test-step><max-errors>10</max-errors></con:configuration></con:assertion><con:maxAssertionErrors>100</con:maxAssertionErrors><con:cancelExcessiveThreads>true</con:cancelExcessiveThreads><con:strategyInterval>500</con:strategyInterval></con:loadTest><con:properties/></con:testCase><con:properties><con:property><con:name>path_token</con:name><con:value>https://otk-ifttt.tutorial.com:443/auth/oauth/v2/token</con:value></con:property><con:property><con:name>path_authorize</con:name><con:value>https://otk-ifttt.tutorial.com:443/auth/oauth/v2/authorize</con:value></con:property><con:property><con:name>path_userinfo</con:name><con:value>https://otk-ifttt.tutorial.com:443/openid/connect/v1/userinfo</con:value></con:property><con:property><con:name>path_jwks</con:name><con:value>https://otk-ifttt.tutorial.com:443/openid/connect/jwks.json</con:value></con:property><con:property><con:name>client_id</con:name><con:value xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">0fb0fd49-199e-4e15-8d53-785ae4af9360</con:value></con:property><con:property><con:name>client_secret</con:name><con:value xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">f0125107-9ef7-4fa7-8c6d-39a72a3cd4d6</con:value></con:property><con:property><con:name>scope</con:name><con:value xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">openid email profile openid_client_registration</con:value></con:property></con:properties></con:testSuite><con:properties><con:property><con:name>host</con:name><con:value>https://otk-ifttt.tutorial.com</con:value></con:property><con:property><con:name>password</con:name><con:value>Mr_ift_@234pas$word</con:value></con:property><con:property><con:name>path_configuration</con:name><con:value>/.well-known/openid-configuration</con:value></con:property><con:property><con:name>contact_alias</con:name><con:value>username</con:value></con:property><con:property><con:name>contact_email</con:name><con:value>username@otk.com</con:value></con:property><con:property><con:name>client_name</con:name><con:value>CA OTK Demo Test Suite</con:value></con:property><con:property><con:name>application_type</con:name><con:value>web</con:value></con:property><con:property><con:name>redirect_uri</con:name><con:value>https://otk-ifttt.tutorial.com/soapui</con:value></con:property><con:property><con:name>user</con:name><con:value>mr_ifttt</con:value></con:property><con:property><con:name>ifttt-service-key</con:name><con:value>CONFIURE_YOUR_OWN_VALUE</con:value></con:property><con:property><con:name>path_base</con:name><con:value>/tutorial/otk/ifttt</con:value></con:property><con:property><con:name>path_test_setup</con:name><con:value>/ifttt/v1/test/setup</con:value></con:property><con:property><con:name>path_status</con:name><con:value>/ifttt/v1/status</con:value></con:property><con:property><con:name>path_userinfo</con:name><con:value>/ifttt/v1/user/info</con:value></con:property><con:property><con:name>path_triggers_new_thing_created</con:name><con:value>/ifttt/v1/triggers/new_thing_created</con:value></con:property><con:property><con:name>path_triggers_account_monitor</con:name><con:value>/ifttt/v1/triggers/account_monitor</con:value></con:property></con:properties><con:wssContainer/><con:oAuth2ProfileContainer/><con:oAuth1ProfileContainer/><con:sensitiveInformation/></con:soapui-project>